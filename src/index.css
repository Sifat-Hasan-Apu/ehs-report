@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  body {
    @apply bg-slate-200 text-slate-900 font-sans antialiased selection:bg-brand-500 selection:text-white;
  }
}

@layer utilities {
  .glass {
    @apply bg-white/95 backdrop-blur-xl border border-white/50 shadow-lg;
  }

  .glass-card {
    @apply bg-white backdrop-blur-xl border border-white/60 shadow-xl transition-all duration-300 hover:shadow-2xl;
  }

  /* Hide scrollbar for horizontal tabs */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Touch-friendly tap targets */
  .touch-target {
    min-height: 44px;
    min-width: 44px;
  }
}

/* --- PRINT & PDF PRODUCTION STYLES --- */
@media print {
  @page {
    size: A4;
    margin: 0;
    /* WE HANDLE MARGINS VIA PADDING IN .report-container */
  }

  body {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    background: white;
  }

  /* Hide UI Elements */
  .no-print,
  button,
  select,
  nav,
  aside,
  .sticky {
    display: none !important;
  }
}

/* 
  Container simulating A4 paper on screen & PDF 
  This is the key to WYSIWYG consistency
*/
.report-wrapper {
  background-color: #525659;
  /* Standard PDF viewer background */
  padding: 2rem;
  display: flex;
  justify-content: center;
}

body.pdf-generating .report-wrapper {
  padding: 0;
  background-color: white;
  display: block;
}

.report-container {
  width: 210mm;
  min-height: 297mm;
  background: white;
  padding: 20mm;
  /* STANDARD A4 MARGIN */
  margin: 0 auto;
  box-sizing: border-box;
  position: relative;
  /* Reset tailwind defaults inside */
  font-family: ui-sans-serif, system-ui, sans-serif;
  color: #333;
}

/* Force specific behavior during generation */
body.pdf-generating .report-container {
  margin: 0 !important;
  width: 100% !important;
  max-width: 794px !important;
  box-shadow: none !important;
  overflow: hidden !important;
}

/* Ensure first page starts immediately without blank page */
body.pdf-generating .report-container>div:first-child {
  page-break-before: avoid !important;
  break-before: avoid !important;
}

/* Page break handling for PDF generation */
body.pdf-generating .pdf-page-break {
  page-break-before: always !important;
  break-before: page !important;
}

/* Constrain all images inside PDF to prevent overflow */
body.pdf-generating img {
  max-width: 100% !important;
  object-fit: contain !important;
}

/* But preserve explicit logo heights */
body.pdf-generating .company-logo,
body.pdf-generating .logo-large {
  height: 40px !important;
  width: auto !important;
  object-fit: contain !important;
}

body.pdf-generating .pdf-cover-header .logo-large {
  height: 80px !important;
}

/* VIEW TOGGLING (Show Web by default, Show Print only when generating) */
.print-view {
  display: none;
}

body.pdf-generating .print-view {
  display: block !important;
}

body.pdf-generating .web-view {
  display: none !important;
}

/* SECTION HANDLING */
.report-section {
  margin-bottom: 30px;
  break-inside: avoid;
  /* Keep small sections together */
  page-break-inside: avoid;
}

.report-section.large {
  break-inside: auto;
  /* Allow large sections to break */
}

/* TABLE STYLING - CRITICAL FOR PDF HEADER REPEATS */
.ehs-table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
  font-size: 10pt;
}

.ehs-table th,
.ehs-table td {
  border: 1px solid #e2e8f0;
  padding: 10px;
  text-align: left;
}

.ehs-table thead {
  display: table-header-group !important;
  /* REPEATS HEADER ON NEW PAGE */
  background-color: #f8f9fa;
  break-inside: avoid;
}

.ehs-table tr {
  page-break-inside: avoid !important;
  /* PREVENTS ROW CUTTING */
  break-inside: avoid !important;
}

/* UTILITIES */
.page-break {
  page-break-before: always;
  break-before: page;
}

.text-dark {
  color: #0f172a !important;
}

/* Reset Grid for Print */
@media print,
screen {
  body.pdf-generating .grid-print-2 {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 20px !important;
  }
}

/* ========================================
   CORPORATE PDF STYLING (FORMAL REPORT)
   ======================================== */

/* PDF Page Header - Repeats on each page */
.pdf-page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 10px;
  border-bottom: 2px solid #1e3a5f;
  margin-bottom: 20px;
}

.pdf-page-header .company-logo {
  height: 40px;
  width: auto;
}

.pdf-page-header .company-name {
  font-size: 10pt;
  font-weight: 700;
  color: #1e3a5f;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.pdf-page-header .report-title {
  font-size: 9pt;
  color: #666;
  text-align: right;
}

/* PDF Page Footer - Positioned at bottom */
.pdf-page-footer {
  position: fixed;
  bottom: 15mm;
  left: 20mm;
  right: 20mm;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 8px;
  border-top: 1px solid #ddd;
  font-size: 8pt;
  color: #888;
  z-index: 100;
  /* Ensure footer starts appearing from first page */
}

.pdf-page-footer .confidential {
  font-style: italic;
  color: #c00;
}

.pdf-page-footer .page-number {
  font-weight: 600;
  color: #333;
}

/* PDF Cover Page */
.pdf-cover-page {
  min-height: 230mm;
  max-height: 260mm;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  /* Height tuned to fill one page with margins but not overflow into a blank page */
}

.pdf-cover-header {
  text-align: center;
  padding: 30px 0;
  border-bottom: 3px solid #1e3a5f;
  margin-bottom: 40px;
}

.pdf-cover-header .logo-large {
  height: 80px;
  width: auto;
  margin-bottom: 15px;
}

.pdf-cover-header .company-name-large {
  font-size: 18pt;
  font-weight: 800;
  color: #1e3a5f;
  text-transform: uppercase;
  letter-spacing: 2px;
  margin: 0;
}

.pdf-cover-title {
  text-align: center;
  margin: 60px 0;
}

.pdf-cover-title h1 {
  font-size: 24pt;
  font-weight: 700;
  color: #333;
  text-transform: uppercase;
  letter-spacing: 3px;
  margin: 0 0 10px 0;
}

.pdf-cover-title .period {
  font-size: 14pt;
  color: #666;
  font-weight: 500;
}

/* PDF Section Headers */
.pdf-section-header {
  font-size: 14pt;
  font-weight: 700;
  color: #1e3a5f;
  text-transform: uppercase;
  letter-spacing: 1px;
  padding-bottom: 8px;
  border-bottom: 2px solid #1e3a5f;
  margin-bottom: 15px;
  page-break-after: avoid;
}

.pdf-subsection-header {
  font-size: 11pt;
  font-weight: 600;
  color: #333;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin: 15px 0 10px 0;
  padding-bottom: 5px;
  border-bottom: 1px solid #ccc;
}

.pdf-objectives-list {
  margin: 0;
  padding-left: 0;
  list-style: disc;
  list-style-position: inside;
}

.pdf-objectives-list ::marker {
  color: #3b82f6;
  font-size: 0.95em;
}

.pdf-objectives-item {
  font-size: 10pt;
  line-height: 1.5;
  color: #475569;
  margin: 0 0 12px 0;
  padding-left: 0;
  text-indent: -6px;
}

.pdf-objectives-empty {
  font-size: 10pt;
  color: #94a3b8;
  font-style: italic;
  margin: 0;
}

/* PDF Tables - Corporate Style */
.pdf-table {
  width: 100%;
  border-collapse: collapse;
  margin: 10px 0 20px 0;
  font-size: 9pt;
}

.pdf-table th {
  background-color: #1e3a5f;
  color: white;
  font-weight: 600;
  text-transform: uppercase;
  font-size: 8pt;
  letter-spacing: 0.5px;
  padding: 10px 8px;
  text-align: left;
  border: 1px solid #1e3a5f;
}

.pdf-table td {
  padding: 8px;
  border: 1px solid #ddd;
  vertical-align: top;
}

.pdf-table tr:nth-child(even) {
  background-color: #f8f9fa;
}

.pdf-table tr {
  page-break-inside: avoid !important;
  break-inside: avoid !important;
}

/* PDF Info Grid */
.pdf-info-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  margin: 15px 0;
}

.pdf-info-box {
  border: 1px solid #ddd;
  padding: 12px;
  border-radius: 4px;
}

.pdf-info-box .label {
  font-size: 8pt;
  font-weight: 600;
  color: #666;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 4px;
}

.pdf-info-box .value {
  font-size: 11pt;
  font-weight: 600;
  color: #333;
}

/* PDF KPI Cards */
.pdf-kpi-grid {
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  gap: 10px;
  margin: 15px 0;
}

.pdf-kpi-card {
  text-align: center;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.pdf-kpi-card .kpi-label {
  font-size: 7pt;
  font-weight: 600;
  color: #666;
  text-transform: uppercase;
  margin-bottom: 5px;
}

.pdf-kpi-card .kpi-value {
  font-size: 16pt;
  font-weight: 800;
  color: #1e3a5f;
}

.pdf-kpi-card .kpi-value.danger {
  color: #c00;
}

/* PDF Inspection Cards */
.pdf-inspection-card {
  border: 1px solid #ddd;
  border-radius: 4px;
  margin-bottom: 20px;
  page-break-inside: avoid;
  break-inside: avoid;
}

.pdf-inspection-header {
  background: #f1f5f9;
  padding: 10px 12px;
  border-bottom: 1px solid #ddd;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.pdf-inspection-header .title {
  font-weight: 600;
  font-size: 10pt;
  color: #333;
}

.pdf-inspection-header .badge {
  font-size: 8pt;
  padding: 3px 8px;
  border-radius: 3px;
  font-weight: 600;
}

.pdf-inspection-header .badge.open {
  background: #fef3c7;
  color: #92400e;
}

.pdf-inspection-header .badge.closed {
  background: #d1fae5;
  color: #065f46;
}

.pdf-inspection-body {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  padding: 15px;
}

.pdf-inspection-column {
  border: 1px solid #e5e7eb;
  border-radius: 4px;
  overflow: hidden;
}

.pdf-inspection-column .column-header {
  padding: 8px 10px;
  font-size: 8pt;
  font-weight: 600;
  text-transform: uppercase;
}

.pdf-inspection-column .column-header.nc {
  background: #fee2e2;
  color: #991b1b;
}

.pdf-inspection-column .column-header.ca {
  background: #d1fae5;
  color: #065f46;
}

.pdf-inspection-column .column-image {
  height: 120px;
  background: #f3f4f6;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.pdf-inspection-column .column-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.pdf-inspection-column .column-text {
  padding: 10px;
  font-size: 9pt;
  color: #333;
}

/* PDF List Styles */
.pdf-list {
  margin: 10px 0;
  padding-left: 20px;
}

.pdf-list li {
  font-size: 10pt;
  margin-bottom: 6px;
  color: #333;
}

.pdf-list li::marker {
  color: #1e3a5f;
}

/* PDF Signature Section */
.pdf-signature-section {
  margin-top: 40px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 40px;
}

.pdf-signature-box {
  text-align: center;
}

.pdf-signature-box .line {
  border-top: 1px solid #333;
  width: 80%;
  margin: 40px auto 10px;
}

.pdf-signature-box .role {
  font-size: 10pt;
  font-weight: 600;
  color: #333;
}

.pdf-signature-box .name-date {
  font-size: 9pt;
  color: #666;
  margin-top: 5px;
}

/* Force page breaks - Each section gets its own page */
.pdf-page-break {
  page-break-before: always;
  break-before: page;
  padding: 5px 0 30px 0;
}

/* First page should not have page break before it */
.pdf-cover-page+.pdf-page-break {
  page-break-before: always;
  break-before: page;
}

/* Keep together */
.pdf-keep-together {
  page-break-inside: avoid;
  break-inside: avoid;
  margin-bottom: 16px;
}

/* Ensure page header never gets clipped */
.pdf-page-header {
  page-break-after: avoid !important;
  break-after: avoid !important;
  page-break-inside: avoid !important;
  break-inside: avoid !important;
}

/* Section header stays with content below */
.pdf-section-header {
  page-break-after: avoid !important;
  break-after: avoid !important;
}

/* ========================================
   ENHANCED PDF STYLES (v2)
   ======================================== */

/* --- Site Inspection Cards (Full Detail) --- */
.pdf-inspection-card-v2 {
  border: 1px solid #d1d5db;
  border-radius: 6px;
  margin-bottom: 20px;
  page-break-inside: avoid;
  break-inside: avoid;
  overflow: hidden;
}

.pdf-inspection-card-v2 .insp-header {
  background: #f1f5f9;
  padding: 10px 14px;
  border-bottom: 1px solid #d1d5db;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.pdf-inspection-card-v2 .insp-header .insp-title {
  font-weight: 700;
  font-size: 10pt;
  color: #1e293b;
}

.pdf-inspection-card-v2 .insp-meta-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 8px;
  padding: 10px 14px;
  background: #f8fafc;
  border-bottom: 1px solid #e2e8f0;
}

.pdf-inspection-card-v2 .insp-meta-item .meta-label {
  font-size: 7pt;
  font-weight: 700;
  color: #94a3b8;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 2px;
}

.pdf-inspection-card-v2 .insp-meta-item .meta-value {
  font-size: 9pt;
  font-weight: 600;
  color: #334155;
}

.pdf-inspection-card-v2 .insp-images {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  padding: 12px 14px;
}

.pdf-inspection-card-v2 .insp-img-col {
  border: 1px solid #e2e8f0;
  border-radius: 4px;
  overflow: hidden;
}

.pdf-inspection-card-v2 .insp-img-col .img-label {
  padding: 6px 10px;
  font-size: 7pt;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.pdf-inspection-card-v2 .insp-img-col .img-label.nc-label {
  background: #fee2e2;
  color: #991b1b;
}

.pdf-inspection-card-v2 .insp-img-col .img-label.ca-label {
  background: #d1fae5;
  color: #065f46;
}

.pdf-inspection-card-v2 .insp-img-col .img-label.obs-label {
  background: #dbeafe;
  color: #1e40af;
}

.pdf-inspection-card-v2 .insp-img-container {
  min-height: 100px;
  max-height: 160px;
  background: #f9fafb;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  padding: 4px;
}

.pdf-inspection-card-v2 .insp-img-container img {
  max-width: 100%;
  max-height: 150px;
  object-fit: contain;
}

.pdf-inspection-card-v2 .insp-img-col .img-desc {
  padding: 8px 10px;
  font-size: 9pt;
  color: #475569;
  border-top: 1px solid #e2e8f0;
  background: #fff;
}

.pdf-inspection-card-v2 .insp-footer {
  display: grid;
  grid-template-columns: 2fr 1fr 1fr;
  gap: 8px;
  padding: 10px 14px;
  background: #f8fafc;
  border-top: 1px solid #e2e8f0;
}

.pdf-inspection-card-v2 .insp-footer .footer-label {
  font-size: 7pt;
  font-weight: 700;
  color: #94a3b8;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 2px;
}

.pdf-inspection-card-v2 .insp-footer .footer-value {
  font-size: 9pt;
  font-weight: 600;
  color: #334155;
}

/* --- Badges for PDF --- */
.pdf-badge {
  display: inline-block;
  font-size: 7pt;
  padding: 2px 8px;
  border-radius: 3px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.3px;
}

.pdf-badge.open {
  background: #fef3c7;
  color: #92400e;
  border: 1px solid #fde68a;
}

.pdf-badge.closed {
  background: #d1fae5;
  color: #065f46;
  border: 1px solid #a7f3d0;
}

.pdf-badge.safe-act {
  background: #d1fae5;
  color: #065f46;
  border: 1px solid #a7f3d0;
}

.pdf-badge.unsafe-act {
  background: #fef3c7;
  color: #92400e;
  border: 1px solid #fde68a;
}

.pdf-badge.unsafe-condition {
  background: #fee2e2;
  color: #991b1b;
  border: 1px solid #fecaca;
}

.pdf-badge.risk-high {
  background: #fee2e2;
  color: #991b1b;
}

.pdf-badge.risk-medium {
  background: #fef3c7;
  color: #92400e;
}

.pdf-badge.risk-low {
  background: #d1fae5;
  color: #065f46;
}

/* --- Incident Detail Sections (PDF) --- */
.pdf-incident-report {
  border: 1px solid #d1d5db;
  border-radius: 6px;
  margin-bottom: 20px;
  overflow: hidden;
  page-break-inside: auto;
  break-inside: auto;
}

.pdf-incident-report.allow-break {
  page-break-inside: auto;
  break-inside: auto;
}

.pdf-incident-banner {
  padding: 12px 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid #d1d5db;
}

.pdf-incident-banner.fire {
  background: #fef2f2;
  border-left: 4px solid #ef4444;
}

.pdf-incident-banner.firstaid {
  background: #fff1f2;
  border-left: 4px solid #f43f5e;
}

.pdf-incident-banner.ffh {
  background: #fff7ed;
  border-left: 4px solid #f97316;
}

.pdf-incident-banner .inc-title {
  font-size: 11pt;
  font-weight: 700;
  color: #1e293b;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.pdf-incident-banner .inc-meta {
  font-size: 8pt;
  color: #64748b;
  text-align: right;
}

.pdf-incident-body {
  padding: 14px 16px;
}

.pdf-incident-body .inc-section-title {
  font-size: 9pt;
  font-weight: 700;
  color: #475569;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin: 14px 0 8px 0;
  padding-bottom: 4px;
  border-bottom: 1px solid #e2e8f0;
}

.pdf-incident-body .inc-section-title:first-child {
  margin-top: 0;
}

.pdf-incident-detail-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
  margin-bottom: 10px;
}

.pdf-incident-detail-grid .detail-item .d-label {
  font-size: 7pt;
  font-weight: 700;
  color: #94a3b8;
  text-transform: uppercase;
  letter-spacing: 0.3px;
  margin-bottom: 2px;
}

.pdf-incident-detail-grid .detail-item .d-value {
  font-size: 9pt;
  font-weight: 600;
  color: #334155;
}

.pdf-incident-narrative {
  background: #f8fafc;
  border: 1px solid #e2e8f0;
  border-radius: 4px;
  padding: 10px 12px;
  font-size: 9pt;
  color: #475569;
  line-height: 1.6;
  margin-bottom: 10px;
}

/* --- Evidence Photo Grid (PDF) --- */
.pdf-evidence-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin: 10px 0;
}

.pdf-evidence-grid.cols-3 {
  grid-template-columns: repeat(3, 1fr);
}

.pdf-evidence-item {
  border: 1px solid #e2e8f0;
  border-radius: 4px;
  overflow: hidden;
  page-break-inside: avoid !important;
  break-inside: avoid !important;
}

.pdf-evidence-item .evidence-img {
  min-height: 80px;
  max-height: 140px;
  background: #f9fafb;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 4px;
  overflow: hidden;
}

.pdf-evidence-item .evidence-img img {
  max-width: 100%;
  max-height: 130px;
  object-fit: contain;
}

.pdf-evidence-item .evidence-caption {
  padding: 5px 8px;
  font-size: 8pt;
  color: #64748b;
  border-top: 1px solid #e2e8f0;
  background: #f8fafc;
  text-align: center;
}

/* --- CAPA Table (PDF) --- */
.pdf-capa-table {
  width: 100%;
  border-collapse: collapse;
  margin: 8px 0;
  font-size: 8pt;
}

.pdf-capa-table th {
  background-color: #475569;
  color: white;
  font-weight: 600;
  text-transform: uppercase;
  font-size: 7pt;
  letter-spacing: 0.3px;
  padding: 6px 8px;
  text-align: left;
  border: 1px solid #475569;
}

.pdf-capa-table td {
  padding: 6px 8px;
  border: 1px solid #e2e8f0;
  vertical-align: top;
  font-size: 8pt;
  color: #334155;
}

.pdf-capa-table tr:nth-child(even) {
  background-color: #f8f9fa;
}

.pdf-capa-table tr {
  page-break-inside: avoid !important;
  break-inside: avoid !important;
}

/* --- PPE / Check items for PDF --- */
.pdf-check-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 6px;
  margin: 6px 0;
}

.pdf-check-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 5px 8px;
  border: 1px solid #e2e8f0;
  border-radius: 3px;
  font-size: 8pt;
}

.pdf-check-item .check-label {
  color: #64748b;
  font-weight: 500;
}

.pdf-check-item .check-value {
  font-weight: 700;
}

.pdf-check-item .check-value.yes {
  color: #16a34a;
}

.pdf-check-item .check-value.no {
  color: #dc2626;
}